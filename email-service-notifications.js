// ============================================
// SERVICIO DE NOTIFICACIONES CON SENDGRID
// ============================================

const sgMail = require('@sendgrid/mail');
require('dotenv').config();

class NotificationService {
    constructor() {
        this.initialized = false;
        this.initializeSendGrid();
    }

    initializeSendGrid() {
        try {
            const apiKey = process.env.SENDGRID_API_KEY;
            if (!apiKey) {
                console.log('âš ï¸  SendGrid no configurado');
                return;
            }
            sgMail.setApiKey(apiKey);
            this.initialized = true;
            console.log('âœ… Servicio de notificaciones por email inicializado correctamente');
        } catch (error) {
            console.error('âŒ Error:', error);
        }
    }

    async enviarEmail(to, subject, html) {
        if (!this.initialized) {
            console.log('âš ï¸  Email no enviado - SendGrid no configurado');
            return { success: false };
        }
        
        try {
            const msg = {
                to,
                from: {
                    email: process.env.SENDGRID_FROM_EMAIL || 'coomotorneivasistemaderegalos@gmail.com',
                    name: process.env.SENDGRID_FROM_NAME || 'COOMOTOR Regalos'
                },
                subject,
                html,
                trackingSettings: {
                    clickTracking: { enable: false },
                    openTracking: { enable: false }
                },
                mailSettings: {
                    sandboxMode: { enable: false }
                },
                text: subject
            };
            
            await sgMail.send(msg);
            console.log(`ğŸ“§ Email enviado a ${to}: ${subject}`);
            return { success: true };
        } catch (error) {
            console.error('âŒ Error al enviar email:', error.message);
            if (error.response) {
                console.error('Detalles:', error.response.body);
            }
            return { success: false };
        }
    }


    // PLANTILLA: PostulaciÃ³n Aprobada - DiseÃ±o espectacular
    async notificarPostulacionAprobada(datos) {
        const html = `<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');body{margin:0;padding:0;font-family:'Poppins',Arial,sans-serif}</style></head><body style="margin:0;padding:0;background:linear-gradient(135deg,#1e3c72 0%,#2a5298 100%)"><table width="100%" cellpadding="0" cellspacing="0" style="padding:40px 20px"><tr><td align="center"><table width="600" cellpadding="0" cellspacing="0" style="background:white;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#c41e3a 100%);padding:50px 30px;text-align:center"><div style="font-size:80px;margin-bottom:10px">ğŸ„</div><h1 style="margin:0;color:white;font-size:36px;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.3)">COOMOTOR</h1><p style="margin:10px 0 0 0;color:rgba(255,255,255,0.9);font-size:16px">Sistema de Regalos NavideÃ±os 2024</p></td></tr><tr><td style="padding:50px 40px"><table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:30px"><tr><td align="center"><div style="background:linear-gradient(135deg,#11998e 0%,#38ef7d 100%);padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(17,153,142,0.3)"><div style="font-size:60px;margin-bottom:10px">ğŸ‰</div><h2 style="margin:0;color:white;font-size:28px;font-weight:700;text-shadow:1px 1px 2px rgba(0,0,0,0.2)">Â¡POSTULACIÃ“N APROBADA!</h2></div></td></tr></table><p style="margin:0 0 20px 0;font-size:18px;line-height:1.6;color:#333">Estimado/a <strong style="color:#2563eb">${datos.nombreEmpleado}</strong>,</p><p style="margin:0 0 25px 0;font-size:16px;line-height:1.8;color:#555">Nos complace informarte que tu postulaciÃ³n para <strong style="color:#c41e3a">${datos.nombreHijo}</strong> ha sido <strong style="color:#11998e">APROBADA</strong> exitosamente.</p><table width="100%" cellpadding="0" cellspacing="0" style="background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);border-radius:12px;margin:30px 0;overflow:hidden"><tr><td style="padding:25px;color:white"><table width="100%" cellpadding="0" cellspacing="0"><tr><td style="font-size:14px;font-weight:600;opacity:0.9;padding-bottom:8px">INFORMACIÃ“N DEL NIÃ‘O/A</td></tr><tr><td style="font-size:24px;font-weight:700">${datos.nombreHijo}</td></tr><tr><td style="font-size:16px;padding-top:5px"><strong>Edad:</strong> ${datos.edad} aÃ±os ğŸ‚</td></tr></table></td></tr></table><p style="margin:25px 0;font-size:16px;line-height:1.8;color:#555">Pronto recibirÃ¡s mÃ¡s informaciÃ³n sobre la <strong>fecha y lugar de entrega</strong> del regalo.</p><table width="100%" cellpadding="0" cellspacing="0" style="margin-top:40px"><tr><td align="center" style="padding:25px;background:linear-gradient(135deg,#ffecd2 0%,#fcb69f 100%);border-radius:12px"><p style="margin:0;font-size:20px;font-weight:600;color:#c41e3a">Â¡Felices Fiestas! ğŸ…ğŸâœ¨</p><p style="margin:10px 0 0 0;font-size:14px;color:#666">Que la magia de la Navidad llene tu hogar de alegrÃ­a</p></td></tr></table></td></tr><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#1a5c3a 100%);padding:30px;text-align:center"><p style="margin:0 0 5px 0;font-size:14px;color:white;font-weight:600">COOMOTOR</p><p style="margin:0;font-size:12px;color:rgba(255,255,255,0.8)">Cooperativa de Motoristas del Huila</p><p style="margin:10px 0 0 0;font-size:12px;color:rgba(255,255,255,0.7)">Neiva, Huila - Colombia ğŸ‡¨ğŸ‡´</p></td></tr></table></td></tr></table></body></html>`;
        return await this.enviarEmail(datos.email, 'ğŸ‰ Â¡PostulaciÃ³n Aprobada! - COOMOTOR', html);
    }


    // PLANTILLA: PostulaciÃ³n Rechazada
    async notificarPostulacionRechazada(datos) {
        const html = `<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');body{margin:0;padding:0;font-family:'Poppins',Arial,sans-serif}</style></head><body style="margin:0;padding:0;background:linear-gradient(135deg,#434343 0%,#000000 100%)"><table width="100%" cellpadding="0" cellspacing="0" style="padding:40px 20px"><tr><td align="center"><table width="600" cellpadding="0" cellspacing="0" style="background:white;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#c41e3a 100%);padding:50px 30px;text-align:center"><div style="font-size:80px;margin-bottom:10px">ğŸ„</div><h1 style="margin:0;color:white;font-size:36px;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.3)">COOMOTOR</h1><p style="margin:10px 0 0 0;color:rgba(255,255,255,0.9);font-size:16px">Sistema de Regalos NavideÃ±os 2024</p></td></tr><tr><td style="padding:50px 40px"><table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:30px"><tr><td align="center"><div style="background:linear-gradient(135deg,#ff6b6b 0%,#ee5a6f 100%);padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(255,107,107,0.3)"><div style="font-size:60px;margin-bottom:10px">ğŸ“‹</div><h2 style="margin:0;color:white;font-size:28px;font-weight:700;text-shadow:1px 1px 2px rgba(0,0,0,0.2)">ActualizaciÃ³n de PostulaciÃ³n</h2></div></td></tr></table><p style="margin:0 0 20px 0;font-size:18px;line-height:1.6;color:#333">Estimado/a <strong style="color:#2563eb">${datos.nombreEmpleado}</strong>,</p><p style="margin:0 0 25px 0;font-size:16px;line-height:1.8;color:#555">Lamentamos informarte que tu postulaciÃ³n para <strong style="color:#c41e3a">${datos.nombreHijo}</strong> no ha sido aprobada en esta ocasiÃ³n.</p>${datos.motivo ? `<table width="100%" cellpadding="0" cellspacing="0" style="background:#fff3cd;border-left:4px solid #ffc107;border-radius:8px;margin:25px 0"><tr><td style="padding:20px"><p style="margin:0 0 10px 0;font-size:14px;font-weight:600;color:#856404">MOTIVO:</p><p style="margin:0;font-size:15px;line-height:1.6;color:#856404">${datos.motivo}</p></td></tr></table>` : ''}<p style="margin:25px 0;font-size:16px;line-height:1.8;color:#555">Agradecemos tu comprensiÃ³n y participaciÃ³n en nuestro programa de regalos navideÃ±os.</p><table width="100%" cellpadding="0" cellspacing="0" style="margin-top:40px"><tr><td align="center" style="padding:25px;background:linear-gradient(135deg,#ffecd2 0%,#fcb69f 100%);border-radius:12px"><p style="margin:0;font-size:18px;font-weight:600;color:#c41e3a">Gracias por tu participaciÃ³n</p><p style="margin:10px 0 0 0;font-size:14px;color:#666">COOMOTOR - Juntos construimos futuro</p></td></tr></table></td></tr><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#1a5c3a 100%);padding:30px;text-align:center"><p style="margin:0 0 5px 0;font-size:14px;color:white;font-weight:600">COOMOTOR</p><p style="margin:0;font-size:12px;color:rgba(255,255,255,0.8)">Cooperativa de Motoristas del Huila</p><p style="margin:10px 0 0 0;font-size:12px;color:rgba(255,255,255,0.7)">Neiva, Huila - Colombia ğŸ‡¨ğŸ‡´</p></td></tr></table></td></tr></table></body></html>`;
        return await this.enviarEmail(datos.email, 'ğŸ“‹ ActualizaciÃ³n de PostulaciÃ³n - COOMOTOR', html);
    }


    // PLANTILLA: Respuesta de Contacto
    async notificarRespuestaContacto(datos) {
        const html = `<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');body{margin:0;padding:0;font-family:'Poppins',Arial,sans-serif}</style></head><body style="margin:0;padding:0;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)"><table width="100%" cellpadding="0" cellspacing="0" style="padding:40px 20px"><tr><td align="center"><table width="600" cellpadding="0" cellspacing="0" style="background:white;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#c41e3a 100%);padding:50px 30px;text-align:center"><div style="font-size:80px;margin-bottom:10px">ğŸ’¬</div><h1 style="margin:0;color:white;font-size:36px;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.3)">COOMOTOR</h1><p style="margin:10px 0 0 0;color:rgba(255,255,255,0.9);font-size:16px">Respuesta a tu Mensaje</p></td></tr><tr><td style="padding:50px 40px"><table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:30px"><tr><td align="center"><div style="background:linear-gradient(135deg,#4facfe 0%,#00f2fe 100%);padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(79,172,254,0.3)"><div style="font-size:60px;margin-bottom:10px">ğŸ“¨</div><h2 style="margin:0;color:white;font-size:28px;font-weight:700;text-shadow:1px 1px 2px rgba(0,0,0,0.2)">Â¡Tenemos una Respuesta!</h2></div></td></tr></table><p style="margin:0 0 20px 0;font-size:18px;line-height:1.6;color:#333">Estimado/a <strong style="color:#2563eb">${datos.nombreUsuario}</strong>,</p><p style="margin:0 0 25px 0;font-size:16px;line-height:1.8;color:#555">Hemos respondido a tu mensaje sobre: <strong style="color:#667eea">"${datos.asunto}"</strong></p><table width="100%" cellpadding="0" cellspacing="0" style="background:linear-gradient(135deg,#a8edea 0%,#fed6e3 100%);border-radius:12px;margin:30px 0;overflow:hidden"><tr><td style="padding:30px"><p style="margin:0 0 15px 0;font-size:14px;font-weight:600;color:#2563eb;text-transform:uppercase;letter-spacing:1px">ğŸ’¬ Nuestra Respuesta:</p><div style="background:white;padding:20px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.1)"><p style="margin:0;font-size:16px;line-height:1.8;color:#333">${datos.respuesta}</p></div></td></tr></table><p style="margin:25px 0;font-size:16px;line-height:1.8;color:#555">Si tienes mÃ¡s preguntas, no dudes en contactarnos nuevamente.</p><table width="100%" cellpadding="0" cellspacing="0" style="margin-top:40px"><tr><td align="center" style="padding:25px;background:linear-gradient(135deg,#ffecd2 0%,#fcb69f 100%);border-radius:12px"><p style="margin:0;font-size:18px;font-weight:600;color:#c41e3a">Gracias por comunicarte con nosotros</p><p style="margin:10px 0 0 0;font-size:14px;color:#666">Estamos aquÃ­ para ayudarte ğŸ¤</p></td></tr></table></td></tr><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#1a5c3a 100%);padding:30px;text-align:center"><p style="margin:0 0 5px 0;font-size:14px;color:white;font-weight:600">COOMOTOR</p><p style="margin:0;font-size:12px;color:rgba(255,255,255,0.8)">Cooperativa de Motoristas del Huila</p><p style="margin:10px 0 0 0;font-size:12px;color:rgba(255,255,255,0.7)">Neiva, Huila - Colombia ğŸ‡¨ğŸ‡´</p></td></tr></table></td></tr></table></body></html>`;
        return await this.enviarEmail(datos.email, `ğŸ’¬ Respuesta: ${datos.asunto} - COOMOTOR`, html);
    }


    // PLANTILLA: CÃ³digo de RecuperaciÃ³n
    async enviarCodigoRecuperacion(datos) {
        const html = `<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');body{margin:0;padding:0;font-family:'Poppins',Arial,sans-serif}</style></head><body style="margin:0;padding:0;background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%)"><table width="100%" cellpadding="0" cellspacing="0" style="padding:40px 20px"><tr><td align="center"><table width="600" cellpadding="0" cellspacing="0" style="background:white;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#c41e3a 100%);padding:50px 30px;text-align:center"><div style="font-size:80px;margin-bottom:10px">ğŸ”</div><h1 style="margin:0;color:white;font-size:36px;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.3)">COOMOTOR</h1><p style="margin:10px 0 0 0;color:rgba(255,255,255,0.9);font-size:16px">RecuperaciÃ³n de ContraseÃ±a</p></td></tr><tr><td style="padding:50px 40px"><table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:30px"><tr><td align="center"><div style="background:linear-gradient(135deg,#fa709a 0%,#fee140 100%);padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(250,112,154,0.3)"><div style="font-size:60px;margin-bottom:10px">ğŸ”‘</div><h2 style="margin:0;color:white;font-size:28px;font-weight:700;text-shadow:1px 1px 2px rgba(0,0,0,0.2)">CÃ³digo de VerificaciÃ³n</h2></div></td></tr></table><p style="margin:0 0 30px 0;font-size:16px;line-height:1.8;color:#555;text-align:center">Usa este cÃ³digo para recuperar tu contraseÃ±a:</p><table width="100%" cellpadding="0" cellspacing="0" style="margin:30px 0"><tr><td align="center"><div style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);padding:40px;border-radius:15px;box-shadow:0 10px 30px rgba(102,126,234,0.4)"><p style="margin:0 0 15px 0;font-size:14px;color:rgba(255,255,255,0.9);font-weight:600;letter-spacing:2px">TU CÃ“DIGO ES:</p><div style="background:white;padding:25px 40px;border-radius:10px;margin:15px 0"><p style="margin:0;font-size:48px;font-weight:700;color:#667eea;letter-spacing:12px;font-family:monospace">${datos.codigo}</p></div><p style="margin:15px 0 0 0;font-size:13px;color:rgba(255,255,255,0.8)">â° Expira en 15 minutos</p></div></td></tr></table><table width="100%" cellpadding="0" cellspacing="0" style="background:#fff3cd;border-left:4px solid #ffc107;border-radius:8px;margin:30px 0"><tr><td style="padding:20px"><p style="margin:0 0 10px 0;font-size:14px;font-weight:600;color:#856404">âš ï¸ IMPORTANTE:</p><ul style="margin:0;padding-left:20px;color:#856404;font-size:14px;line-height:1.8"><li>No compartas este cÃ³digo con nadie</li><li>Si no solicitaste este cambio, ignora este correo</li><li>El cÃ³digo solo es vÃ¡lido por 15 minutos</li></ul></td></tr></table></td></tr><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#1a5c3a 100%);padding:30px;text-align:center"><p style="margin:0 0 5px 0;font-size:14px;color:white;font-weight:600">COOMOTOR</p><p style="margin:0;font-size:12px;color:rgba(255,255,255,0.8)">Cooperativa de Motoristas del Huila</p><p style="margin:10px 0 0 0;font-size:12px;color:rgba(255,255,255,0.7)">Neiva, Huila - Colombia ğŸ‡¨ğŸ‡´</p></td></tr></table></td></tr></table></body></html>`;
        return await this.enviarEmail(datos.email, 'ğŸ” CÃ³digo de RecuperaciÃ³n - COOMOTOR', html);
    }

    // PLANTILLA: ConfirmaciÃ³n de RecuperaciÃ³n
    async enviarConfirmacionRecuperacion(datos) {
        const html = `<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');body{margin:0;padding:0;font-family:'Poppins',Arial,sans-serif}</style></head><body style="margin:0;padding:0;background:linear-gradient(135deg,#11998e 0%,#38ef7d 100%)"><table width="100%" cellpadding="0" cellspacing="0" style="padding:40px 20px"><tr><td align="center"><table width="600" cellpadding="0" cellspacing="0" style="background:white;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#c41e3a 100%);padding:50px 30px;text-align:center"><div style="font-size:80px;margin-bottom:10px">âœ…</div><h1 style="margin:0;color:white;font-size:36px;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.3)">COOMOTOR</h1><p style="margin:10px 0 0 0;color:rgba(255,255,255,0.9);font-size:16px">ContraseÃ±a Actualizada</p></td></tr><tr><td style="padding:50px 40px"><table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:30px"><tr><td align="center"><div style="background:linear-gradient(135deg,#11998e 0%,#38ef7d 100%);padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(17,153,142,0.3)"><div style="font-size:60px;margin-bottom:10px">ğŸ‰</div><h2 style="margin:0;color:white;font-size:28px;font-weight:700;text-shadow:1px 1px 2px rgba(0,0,0,0.2)">Â¡ContraseÃ±a Cambiada!</h2></div></td></tr></table><p style="margin:0 0 25px 0;font-size:16px;line-height:1.8;color:#555;text-align:center">Tu contraseÃ±a ha sido actualizada exitosamente.</p><p style="margin:0 0 25px 0;font-size:16px;line-height:1.8;color:#555;text-align:center">Ya puedes iniciar sesiÃ³n con tu nueva contraseÃ±a.</p><table width="100%" cellpadding="0" cellspacing="0" style="margin-top:40px"><tr><td align="center" style="padding:25px;background:linear-gradient(135deg,#ffecd2 0%,#fcb69f 100%);border-radius:12px"><p style="margin:0;font-size:18px;font-weight:600;color:#2563eb">Â¡Todo listo! ğŸš€</p><p style="margin:10px 0 0 0;font-size:14px;color:#666">Tu cuenta estÃ¡ segura</p></td></tr></table></td></tr><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#1a5c3a 100%);padding:30px;text-align:center"><p style="margin:0 0 5px 0;font-size:14px;color:white;font-weight:600">COOMOTOR</p><p style="margin:0;font-size:12px;color:rgba(255,255,255,0.8)">Cooperativa de Motoristas del Huila</p><p style="margin:10px 0 0 0;font-size:12px;color:rgba(255,255,255,0.7)">Neiva, Huila - Colombia ğŸ‡¨ğŸ‡´</p></td></tr></table></td></tr></table></body></html>`;
        return await this.enviarEmail(datos.email, 'âœ… ContraseÃ±a Actualizada - COOMOTOR', html);
    }

    // PLANTILLA: CÃ³digo 2FA
    async enviarCodigo2FA(datos) {
        const html = `<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');body{margin:0;padding:0;font-family:'Poppins',Arial,sans-serif}</style></head><body style="margin:0;padding:0;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)"><table width="100%" cellpadding="0" cellspacing="0" style="padding:40px 20px"><tr><td align="center"><table width="600" cellpadding="0" cellspacing="0" style="background:white;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#c41e3a 100%);padding:50px 30px;text-align:center"><div style="font-size:80px;margin-bottom:10px">ğŸ”</div><h1 style="margin:0;color:white;font-size:36px;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.3)">COOMOTOR</h1><p style="margin:10px 0 0 0;color:rgba(255,255,255,0.9);font-size:16px">VerificaciÃ³n de Seguridad</p></td></tr><tr><td style="padding:50px 40px"><table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:30px"><tr><td align="center"><div style="background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(240,147,251,0.3)"><div style="font-size:60px;margin-bottom:10px">ğŸ›¡ï¸</div><h2 style="margin:0;color:white;font-size:28px;font-weight:700;text-shadow:1px 1px 2px rgba(0,0,0,0.2)">CÃ³digo de VerificaciÃ³n</h2></div></td></tr></table><p style="margin:0 0 20px 0;font-size:18px;line-height:1.6;color:#333">Hola <strong style="color:#2563eb">${datos.nombre}</strong>,</p><p style="margin:0 0 30px 0;font-size:16px;line-height:1.8;color:#555;text-align:center">Alguien estÃ¡ intentando iniciar sesiÃ³n en tu cuenta. Usa este cÃ³digo para continuar:</p><table width="100%" cellpadding="0" cellspacing="0" style="margin:30px 0"><tr><td align="center"><div style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);padding:40px;border-radius:15px;box-shadow:0 10px 30px rgba(102,126,234,0.4)"><p style="margin:0 0 15px 0;font-size:14px;color:rgba(255,255,255,0.9);font-weight:600;letter-spacing:2px">TU CÃ“DIGO 2FA:</p><div style="background:white;padding:25px 40px;border-radius:10px;margin:15px 0"><p style="margin:0;font-size:48px;font-weight:700;color:#667eea;letter-spacing:12px;font-family:monospace">${datos.codigo}</p></div><p style="margin:15px 0 0 0;font-size:13px;color:rgba(255,255,255,0.8)">â° Expira en 10 minutos</p></div></td></tr></table><table width="100%" cellpadding="0" cellspacing="0" style="background:#fff3cd;border-left:4px solid #ffc107;border-radius:8px;margin:30px 0"><tr><td style="padding:20px"><p style="margin:0 0 10px 0;font-size:14px;font-weight:600;color:#856404">âš ï¸ SEGURIDAD:</p><ul style="margin:0;padding-left:20px;color:#856404;font-size:14px;line-height:1.8"><li>No compartas este cÃ³digo con nadie</li><li>Si no fuiste tÃº, cambia tu contraseÃ±a inmediatamente</li><li>El cÃ³digo solo es vÃ¡lido por 10 minutos</li><li>MÃ¡ximo 3 intentos permitidos</li></ul></td></tr></table><table width="100%" cellpadding="0" cellspacing="0" style="margin-top:40px"><tr><td align="center" style="padding:25px;background:linear-gradient(135deg,#ffecd2 0%,#fcb69f 100%);border-radius:12px"><p style="margin:0;font-size:18px;font-weight:600;color:#c41e3a">Protegemos tu cuenta ğŸ”’</p><p style="margin:10px 0 0 0;font-size:14px;color:#666">AutenticaciÃ³n de dos factores activa</p></td></tr></table></td></tr><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#1a5c3a 100%);padding:30px;text-align:center"><p style="margin:0 0 5px 0;font-size:14px;color:white;font-weight:600">COOMOTOR</p><p style="margin:0;font-size:12px;color:rgba(255,255,255,0.8)">Cooperativa de Motoristas del Huila</p><p style="margin:10px 0 0 0;font-size:12px;color:rgba(255,255,255,0.7)">Neiva, Huila - Colombia ğŸ‡¨ğŸ‡´</p></td></tr></table></td></tr></table></body></html>`;
        return await this.enviarEmail(datos.email, 'ğŸ” CÃ³digo de VerificaciÃ³n 2FA - COOMOTOR', html);
    }

    // PLANTILLA: AprobaciÃ³n Eliminada
    async notificarAprobacionEliminada(datos) {
        const html = `<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');body{margin:0;padding:0;font-family:'Poppins',Arial,sans-serif}</style></head><body style="margin:0;padding:0;background:linear-gradient(135deg,#434343 0%,#000000 100%)"><table width="100%" cellpadding="0" cellspacing="0" style="padding:40px 20px"><tr><td align="center"><table width="600" cellpadding="0" cellspacing="0" style="background:white;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#c41e3a 100%);padding:50px 30px;text-align:center"><div style="font-size:80px;margin-bottom:10px">ğŸ„</div><h1 style="margin:0;color:white;font-size:36px;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.3)">COOMOTOR</h1><p style="margin:10px 0 0 0;color:rgba(255,255,255,0.9);font-size:16px">Sistema de Regalos NavideÃ±os 2024</p></td></tr><tr><td style="padding:50px 40px"><table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:30px"><tr><td align="center"><div style="background:linear-gradient(135deg,#ff9966 0%,#ff5e62 100%);padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(255,153,102,0.3)"><div style="font-size:60px;margin-bottom:10px">âš ï¸</div><h2 style="margin:0;color:white;font-size:28px;font-weight:700;text-shadow:1px 1px 2px rgba(0,0,0,0.2)">Cambio en AprobaciÃ³n</h2></div></td></tr></table><p style="margin:0 0 20px 0;font-size:18px;line-height:1.6;color:#333">Estimado/a <strong style="color:#2563eb">${datos.nombreEmpleado}</strong>,</p><p style="margin:0 0 25px 0;font-size:16px;line-height:1.8;color:#555">Lamentamos informarte que la aprobaciÃ³n previamente otorgada para <strong style="color:#c41e3a">${datos.nombreHijo}</strong> ha sido <strong style="color:#ff5e62">CANCELADA</strong>.</p><table width="100%" cellpadding="0" cellspacing="0" style="background:#fff3cd;border-left:4px solid #ffc107;border-radius:8px;margin:25px 0"><tr><td style="padding:20px"><p style="margin:0 0 10px 0;font-size:14px;font-weight:600;color:#856404">MOTIVO DE LA CANCELACIÃ“N:</p><p style="margin:0;font-size:15px;line-height:1.6;color:#856404">${datos.motivo}</p></td></tr></table><p style="margin:25px 0;font-size:16px;line-height:1.8;color:#555">Entendemos que esta situaciÃ³n puede ser decepcionante. Si tienes alguna pregunta o inquietud, por favor no dudes en contactarnos.</p><table width="100%" cellpadding="0" cellspacing="0" style="margin-top:40px"><tr><td align="center" style="padding:25px;background:linear-gradient(135deg,#ffecd2 0%,#fcb69f 100%);border-radius:12px"><p style="margin:0;font-size:18px;font-weight:600;color:#c41e3a">Disculpa las molestias</p><p style="margin:10px 0 0 0;font-size:14px;color:#666">COOMOTOR - Estamos aquÃ­ para ayudarte</p></td></tr></table></td></tr><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#1a5c3a 100%);padding:30px;text-align:center"><p style="margin:0 0 5px 0;font-size:14px;color:white;font-weight:600">COOMOTOR</p><p style="margin:0;font-size:12px;color:rgba(255,255,255,0.8)">Cooperativa de Motoristas del Huila</p><p style="margin:10px 0 0 0;font-size:12px;color:rgba(255,255,255,0.7)">Neiva, Huila - Colombia ğŸ‡¨ğŸ‡´</p></td></tr></table></td></tr></table></body></html>`;
        return await this.enviarEmail(datos.email, 'âš ï¸ Cambio en AprobaciÃ³n - COOMOTOR', html);
    }


    // MÃ©todos adicionales (alertas y cambios de estado)
    async notificarAlertaPlazo(datos) {
        return { success: true };
    }

    async notificarCambioEstadoRegalo(datos) {
        return { success: true };
    }
    // PLANTILLA: ConfirmaciÃ³n de PostulaciÃ³n
    async notificarConfirmacionPostulacion(datos) {
        const html = `<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');body{margin:0;padding:0;font-family:'Poppins',Arial,sans-serif}</style></head><body style="margin:0;padding:0;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)"><table width="100%" cellpadding="0" cellspacing="0" style="padding:40px 20px"><tr><td align="center"><table width="600" cellpadding="0" cellspacing="0" style="background:white;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#c41e3a 100%);padding:50px 30px;text-align:center"><div style="font-size:80px;margin-bottom:10px">ğŸ„</div><h1 style="margin:0;color:white;font-size:36px;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.3)">COOMOTOR</h1><p style="margin:10px 0 0 0;color:rgba(255,255,255,0.9);font-size:16px">Sistema de Regalos NavideÃ±os 2024</p></td></tr><tr><td style="padding:50px 40px"><table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:30px"><tr><td align="center"><div style="background:linear-gradient(135deg,#11998e 0%,#38ef7d 100%);padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(17,153,142,0.3)"><div style="font-size:60px;margin-bottom:10px">âœ…</div><h2 style="margin:0;color:white;font-size:28px;font-weight:700;text-shadow:1px 1px 2px rgba(0,0,0,0.2)">Â¡PostulaciÃ³n Recibida!</h2></div></td></tr></table><p style="margin:0 0 20px 0;font-size:18px;line-height:1.6;color:#333">Estimado/a <strong style="color:#2563eb">${datos.nombreEmpleado}</strong>,</p><p style="margin:0 0 25px 0;font-size:16px;line-height:1.8;color:#555">Hemos recibido exitosamente tu postulaciÃ³n para <strong style="color:#c41e3a">${datos.nombreHijo}</strong> (${datos.edad} aÃ±os).</p><table width="100%" cellpadding="0" cellspacing="0" style="background:linear-gradient(135deg,#a8edea 0%,#fed6e3 100%);border-radius:12px;margin:30px 0;overflow:hidden"><tr><td style="padding:30px"><p style="margin:0 0 15px 0;font-size:14px;font-weight:600;color:#2563eb;text-transform:uppercase;letter-spacing:1px">ğŸ“‹ PrÃ³ximos Pasos:</p><div style="background:white;padding:20px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.1)"><ol style="margin:0;padding-left:20px;color:#333;font-size:15px;line-height:1.8"><li>Nuestro equipo revisarÃ¡ tu postulaciÃ³n</li><li>Te solicitaremos los documentos necesarios</li><li>RecibirÃ¡s una notificaciÃ³n en tu panel y por correo</li><li>Una vez aprobada, te informaremos sobre la entrega</li></ol></div></td></tr></table><p style="margin:25px 0;font-size:16px;line-height:1.8;color:#555">Mantente atento a tu correo y panel de conductor para futuras actualizaciones.</p><table width="100%" cellpadding="0" cellspacing="0" style="margin-top:40px"><tr><td align="center" style="padding:25px;background:linear-gradient(135deg,#ffecd2 0%,#fcb69f 100%);border-radius:12px"><p style="margin:0;font-size:20px;font-weight:600;color:#c41e3a">Â¡Gracias por participar! ğŸ…ğŸ</p><p style="margin:10px 0 0 0;font-size:14px;color:#666">COOMOTOR - Juntos construimos futuro</p></td></tr></table></td></tr><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#1a5c3a 100%);padding:30px;text-align:center"><p style="margin:0 0 5px 0;font-size:14px;color:white;font-weight:600">COOMOTOR</p><p style="margin:0;font-size:12px;color:rgba(255,255,255,0.8)">Cooperativa de Motoristas del Huila</p><p style="margin:10px 0 0 0;font-size:12px;color:rgba(255,255,255,0.7)">Neiva, Huila - Colombia ğŸ‡¨ğŸ‡´</p></td></tr></table></td></tr></table></body></html>`;
        return await this.enviarEmail(datos.email, 'âœ… PostulaciÃ³n Recibida - COOMOTOR', html);
    }

    // PLANTILLA: Solicitud de Documentos
    async notificarSolicitudDocumentos(datos) {
        const tiposDocumento = {
            'registro_civil': 'Registro Civil',
            'tarjeta_identidad': 'Tarjeta de Identidad',
            'cedula': 'CÃ©dula de CiudadanÃ­a',
            'foto_hijo': 'Foto del Hijo/a',
            'comprobante_residencia': 'Comprobante de Residencia',
            'otro': 'Otro Documento'
        };

        let listaDocumentos = '';
        datos.documentosSolicitados.forEach(doc => {
            listaDocumentos += `<li style="margin-bottom:10px">${tiposDocumento[doc] || doc}</li>`;
        });

        const html = `<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');body{margin:0;padding:0;font-family:'Poppins',Arial,sans-serif}</style></head><body style="margin:0;padding:0;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)"><table width="100%" cellpadding="0" cellspacing="0" style="padding:40px 20px"><tr><td align="center"><table width="600" cellpadding="0" cellspacing="0" style="background:white;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#c41e3a 100%);padding:50px 30px;text-align:center"><div style="font-size:80px;margin-bottom:10px">ğŸ“„</div><h1 style="margin:0;color:white;font-size:36px;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.3)">COOMOTOR</h1><p style="margin:10px 0 0 0;color:rgba(255,255,255,0.9);font-size:16px">Solicitud de Documentos</p></td></tr><tr><td style="padding:50px 40px"><table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:30px"><tr><td align="center"><div style="background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(240,147,251,0.3)"><div style="font-size:60px;margin-bottom:10px">ğŸ“‹</div><h2 style="margin:0;color:white;font-size:28px;font-weight:700;text-shadow:1px 1px 2px rgba(0,0,0,0.2)">Documentos Requeridos</h2></div></td></tr></table><p style="margin:0 0 20px 0;font-size:18px;line-height:1.6;color:#333">Estimado/a <strong style="color:#2563eb">${datos.nombreEmpleado}</strong>,</p><p style="margin:0 0 25px 0;font-size:16px;line-height:1.8;color:#555">Para continuar con la postulaciÃ³n de <strong style="color:#c41e3a">${datos.nombreHijo}</strong>, necesitamos que subas los siguientes documentos:</p><table width="100%" cellpadding="0" cellspacing="0" style="background:linear-gradient(135deg,#a8edea 0%,#fed6e3 100%);border-radius:12px;margin:30px 0;overflow:hidden"><tr><td style="padding:30px"><p style="margin:0 0 15px 0;font-size:14px;font-weight:600;color:#2563eb;text-transform:uppercase;letter-spacing:1px">ğŸ“„ Documentos Solicitados:</p><div style="background:white;padding:20px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.1)"><ul style="margin:0;padding-left:20px;color:#333;font-size:15px;line-height:1.8">${listaDocumentos}</ul></div></td></tr></table>${datos.mensaje ? `<table width="100%" cellpadding="0" cellspacing="0" style="background:#fff3cd;border-left:4px solid #ffc107;border-radius:8px;margin:25px 0"><tr><td style="padding:20px"><p style="margin:0 0 10px 0;font-size:14px;font-weight:600;color:#856404">ğŸ’¬ Mensaje del Administrador:</p><p style="margin:0;font-size:15px;line-height:1.6;color:#856404">${datos.mensaje}</p></td></tr></table>` : ''}<table width="100%" cellpadding="0" cellspacing="0" style="margin-top:40px"><tr><td align="center"><a href="https://coomotor-regalos.onrender.com/dashboards/empleado.html" style="display:inline-block;background:linear-gradient(135deg,#2563eb 0%,#1e40af 100%);color:white;text-decoration:none;padding:15px 40px;border-radius:10px;font-weight:600;font-size:16px;box-shadow:0 4px 12px rgba(46,139,87,0.3)">ğŸ“¤ Subir Documentos Ahora</a></td></tr></table><p style="margin:25px 0 0 0;font-size:14px;line-height:1.8;color:#666;text-align:center">TambiÃ©n puedes subir los documentos desde tu panel de conductor</p></td></tr><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#1a5c3a 100%);padding:30px;text-align:center"><p style="margin:0 0 5px 0;font-size:14px;color:white;font-weight:600">COOMOTOR</p><p style="margin:0;font-size:12px;color:rgba(255,255,255,0.8)">Cooperativa de Motoristas del Huila</p><p style="margin:10px 0 0 0;font-size:12px;color:rgba(255,255,255,0.7)">Neiva, Huila - Colombia ğŸ‡¨ğŸ‡´</p></td></tr></table></td></tr></table></body></html>`;
        
        return await this.enviarEmail(datos.email, 'ğŸ“„ Documentos Requeridos - COOMOTOR', html);
    }

    // PLANTILLA: RevisiÃ³n de Documento
    async notificarRevisionDocumento(usuario, documento) {
        const estadoTexto = documento.estado === 'aprobado' ? 'APROBADO âœ…' : 'REQUIERE REVISIÃ“N âš ï¸';
        const estadoColor = documento.estado === 'aprobado' ? '#11998e' : '#ff6b6b';
        const estadoEmoji = documento.estado === 'aprobado' ? 'âœ…' : 'ğŸ“‹';
        
        const tiposDocumento = {
            'registro_civil': 'Registro Civil',
            'tarjeta_identidad': 'Tarjeta de Identidad',
            'cedula': 'CÃ©dula de CiudadanÃ­a',
            'foto_hijo': 'Foto del Hijo/a',
            'comprobante_residencia': 'Comprobante de Residencia',
            'otro': 'Otro Documento'
        };

        const html = `<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');body{margin:0;padding:0;font-family:'Poppins',Arial,sans-serif}</style></head><body style="margin:0;padding:0;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)"><table width="100%" cellpadding="0" cellspacing="0" style="padding:40px 20px"><tr><td align="center"><table width="600" cellpadding="0" cellspacing="0" style="background:white;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#c41e3a 100%);padding:50px 30px;text-align:center"><div style="font-size:80px;margin-bottom:10px">ğŸ“„</div><h1 style="margin:0;color:white;font-size:36px;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.3)">COOMOTOR</h1><p style="margin:10px 0 0 0;color:rgba(255,255,255,0.9);font-size:16px">RevisiÃ³n de Documento</p></td></tr><tr><td style="padding:50px 40px"><table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:30px"><tr><td align="center"><div style="background:linear-gradient(135deg,${estadoColor} 0%,${estadoColor}dd 100%);padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,0.3)"><div style="font-size:60px;margin-bottom:10px">${estadoEmoji}</div><h2 style="margin:0;color:white;font-size:28px;font-weight:700;text-shadow:1px 1px 2px rgba(0,0,0,0.2)">${estadoTexto}</h2></div></td></tr></table><p style="margin:0 0 20px 0;font-size:18px;line-height:1.6;color:#333">Estimado/a <strong style="color:#2563eb">${usuario.nombres}</strong>,</p><p style="margin:0 0 25px 0;font-size:16px;line-height:1.8;color:#555">Tu documento <strong style="color:#667eea">${tiposDocumento[documento.tipo_documento] || documento.tipo_documento}</strong> ha sido revisado.</p><table width="100%" cellpadding="0" cellspacing="0" style="background:linear-gradient(135deg,#a8edea 0%,#fed6e3 100%);border-radius:12px;margin:30px 0;overflow:hidden"><tr><td style="padding:30px"><p style="margin:0 0 15px 0;font-size:14px;font-weight:600;color:#2563eb;text-transform:uppercase;letter-spacing:1px">ğŸ“‹ Estado del Documento:</p><div style="background:white;padding:20px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.1)"><p style="margin:0 0 10px 0;font-size:18px;font-weight:700;color:${estadoColor}">${estadoTexto}</p>${documento.observaciones ? `<p style="margin:10px 0 0 0;font-size:15px;line-height:1.6;color:#555"><strong>Observaciones:</strong><br>${documento.observaciones}</p>` : ''}</div></td></tr></table>${documento.estado === 'rechazado' ? `<p style="margin:25px 0;font-size:16px;line-height:1.8;color:#555">Por favor, revisa las observaciones y sube nuevamente el documento corregido desde tu panel de conductor.</p>` : `<p style="margin:25px 0;font-size:16px;line-height:1.8;color:#555">Tu documento ha sido aprobado exitosamente. Puedes continuar con el proceso de postulaciÃ³n.</p>`}<table width="100%" cellpadding="0" cellspacing="0" style="margin-top:40px"><tr><td align="center" style="padding:25px;background:linear-gradient(135deg,#ffecd2 0%,#fcb69f 100%);border-radius:12px"><p style="margin:0;font-size:18px;font-weight:600;color:#c41e3a">Gracias por tu colaboraciÃ³n</p><p style="margin:10px 0 0 0;font-size:14px;color:#666">COOMOTOR - Juntos construimos futuro ğŸ¤</p></td></tr></table></td></tr><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#1a5c3a 100%);padding:30px;text-align:center"><p style="margin:0 0 5px 0;font-size:14px;color:white;font-weight:600">COOMOTOR</p><p style="margin:0;font-size:12px;color:rgba(255,255,255,0.8)">Cooperativa de Motoristas del Huila</p><p style="margin:10px 0 0 0;font-size:12px;color:rgba(255,255,255,0.7)">Neiva, Huila - Colombia ğŸ‡¨ğŸ‡´</p></td></tr></table></td></tr></table></body></html>`;
        
        return await this.enviarEmail(usuario.correo, `ğŸ“„ RevisiÃ³n de Documento: ${tiposDocumento[documento.tipo_documento]} - COOMOTOR`, html);
    }

    // PLANTILLA: Cambio de Rol
    async enviarCambioRol(datos) {
        const esAdmin = datos.rolNuevo === 'admin';
        const iconoRol = esAdmin ? 'ğŸ‘‘' : datos.rolNuevo === 'conductor' ? 'ğŸš—' : 'ğŸ‘¤';
        const colorRol = esAdmin ? '#f59e0b' : datos.rolNuevo === 'conductor' ? '#3b82f6' : '#10b981';
        
        const html = `<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');body{margin:0;padding:0;font-family:'Poppins',Arial,sans-serif}</style></head><body style="margin:0;padding:0;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)"><table width="100%" cellpadding="0" cellspacing="0" style="padding:40px 20px"><tr><td align="center"><table width="600" cellpadding="0" cellspacing="0" style="background:white;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#c41e3a 100%);padding:50px 30px;text-align:center"><div style="font-size:80px;margin-bottom:10px">${iconoRol}</div><h1 style="margin:0;color:white;font-size:36px;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.3)">COOMOTOR</h1><p style="margin:10px 0 0 0;color:rgba(255,255,255,0.9);font-size:16px">ActualizaciÃ³n de Permisos</p></td></tr><tr><td style="padding:50px 40px"><table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:30px"><tr><td align="center"><div style="background:linear-gradient(135deg,${colorRol} 0%,${colorRol}dd 100%);padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,0.2)"><div style="font-size:60px;margin-bottom:10px">ğŸ”„</div><h2 style="margin:0;color:white;font-size:28px;font-weight:700;text-shadow:1px 1px 2px rgba(0,0,0,0.2)">Cambio de Rol</h2></div></td></tr></table><p style="margin:0 0 20px 0;font-size:18px;line-height:1.6;color:#333">Hola <strong style="color:#2563eb">${datos.nombre}</strong>,</p><p style="margin:0 0 25px 0;font-size:16px;line-height:1.8;color:#555">Te informamos que tu rol en el sistema ha sido actualizado por un administrador.</p><table width="100%" cellpadding="0" cellspacing="0" style="background:linear-gradient(135deg,#f0f9ff 0%,#e0f2fe 100%);border-radius:12px;margin:30px 0;overflow:hidden"><tr><td style="padding:30px"><table width="100%" cellpadding="0" cellspacing="0"><tr><td style="padding-bottom:15px"><p style="margin:0;font-size:14px;font-weight:600;color:#64748b;text-transform:uppercase">Rol Anterior:</p><p style="margin:5px 0 0 0;font-size:18px;font-weight:700;color:#94a3b8">${datos.rolAnterior}</p></td></tr><tr><td style="padding-top:15px;border-top:2px dashed #cbd5e1"><p style="margin:0;font-size:14px;font-weight:600;color:#2563eb;text-transform:uppercase">Nuevo Rol:</p><p style="margin:5px 0 0 0;font-size:24px;font-weight:900;color:${colorRol}">${iconoRol} ${datos.rolNuevoNombre}</p></td></tr></table></td></tr></table>${esAdmin ? `<table width="100%" cellpadding="0" cellspacing="0" style="background:#fef3c7;border-left:4px solid #f59e0b;border-radius:8px;margin:25px 0"><tr><td style="padding:20px"><p style="margin:0 0 10px 0;font-size:14px;font-weight:600;color:#92400e">ğŸ‘‘ PERMISOS DE ADMINISTRADOR:</p><ul style="margin:0;padding-left:20px;color:#92400e;font-size:14px;line-height:1.8"><li>Gestionar todos los usuarios</li><li>Aprobar/rechazar postulaciones</li><li>Ver reportes y estadÃ­sticas</li><li>Configurar el sistema</li><li>Acceso completo al panel admin</li></ul></td></tr></table><table width="100%" cellpadding="0" cellspacing="0" style="background:#fee2e2;border-left:4px solid #dc2626;border-radius:8px;margin:25px 0"><tr><td style="padding:20px"><p style="margin:0 0 10px 0;font-size:14px;font-weight:600;color:#991b1b">ğŸ” SEGURIDAD IMPORTANTE:</p><ul style="margin:0;padding-left:20px;color:#991b1b;font-size:14px;line-height:1.8"><li>Ahora tu cuenta requiere autenticaciÃ³n de 2 factores (2FA)</li><li>RecibirÃ¡s un cÃ³digo por email cada vez que inicies sesiÃ³n</li><li>Usa una contraseÃ±a fuerte y Ãºnica</li><li>No compartas tus credenciales con nadie</li></ul></td></tr></table>` : ''}<p style="margin:25px 0;font-size:16px;line-height:1.8;color:#555">Si tienes dudas sobre tus nuevos permisos, contacta al administrador del sistema.</p><table width="100%" cellpadding="0" cellspacing="0" style="margin-top:40px"><tr><td align="center" style="padding:25px;background:linear-gradient(135deg,#ffecd2 0%,#fcb69f 100%);border-radius:12px"><p style="margin:0;font-size:18px;font-weight:600;color:#c41e3a">Â¡Bienvenido a tu nuevo rol!</p><p style="margin:10px 0 0 0;font-size:14px;color:#666">COOMOTOR - Juntos construimos futuro</p></td></tr></table></td></tr><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#1a5c3a 100%);padding:30px;text-align:center"><p style="margin:0 0 5px 0;font-size:14px;color:white;font-weight:600">COOMOTOR</p><p style="margin:0;font-size:12px;color:rgba(255,255,255,0.8)">Cooperativa de Motoristas del Huila</p><p style="margin:10px 0 0 0;font-size:12px;color:rgba(255,255,255,0.7)">Neiva, Huila - Colombia ğŸ‡¨ğŸ‡´</p></td></tr></table></td></tr></table></body></html>`;
        
        return await this.enviarEmail(datos.email, `${iconoRol} Cambio de Rol - COOMOTOR`, html);
    }

    // ============================================
    // RECORDATORIOS AUTOMÃTICOS
    // ============================================

    // PLANTILLA: Recordatorio de Documentos Pendientes
    async enviarRecordatorioDocumentos(datos) {
        const urgencia = datos.diasTranscurridos >= 7 ? 'URGENTE' : 'IMPORTANTE';
        const colorUrgencia = datos.diasTranscurridos >= 7 ? '#dc2626' : '#f59e0b';
        
        const html = `<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');body{margin:0;padding:0;font-family:'Poppins',Arial,sans-serif}</style></head><body style="margin:0;padding:0;background:linear-gradient(135deg,#f59e0b 0%,#dc2626 100%)"><table width="100%" cellpadding="0" cellspacing="0" style="padding:40px 20px"><tr><td align="center"><table width="600" cellpadding="0" cellspacing="0" style="background:white;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#c41e3a 100%);padding:50px 30px;text-align:center"><div style="font-size:80px;margin-bottom:10px">ğŸ“„</div><h1 style="margin:0;color:white;font-size:36px;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.3)">COOMOTOR</h1><p style="margin:10px 0 0 0;color:rgba(255,255,255,0.9);font-size:16px">Recordatorio de Documentos</p></td></tr><tr><td style="padding:50px 40px"><table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:30px"><tr><td align="center"><div style="background:linear-gradient(135deg,${colorUrgencia} 0%,${colorUrgencia}dd 100%);padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,0.3)"><div style="font-size:60px;margin-bottom:10px">âš ï¸</div><h2 style="margin:0;color:white;font-size:28px;font-weight:700;text-shadow:1px 1px 2px rgba(0,0,0,0.2)">${urgencia}: Documentos Pendientes</h2></div></td></tr></table><p style="margin:0 0 20px 0;font-size:18px;line-height:1.6;color:#333">Hola <strong style="color:#2563eb">${datos.nombre}</strong>,</p><p style="margin:0 0 25px 0;font-size:16px;line-height:1.8;color:#555">Te recordamos que tienes documentos pendientes de revisiÃ³n en el sistema de regalos navideÃ±os.</p><table width="100%" cellpadding="0" cellspacing="0" style="background:linear-gradient(135deg,#fef3c7 0%,#fed7aa 100%);border-radius:12px;margin:30px 0;overflow:hidden"><tr><td style="padding:30px"><table width="100%" cellpadding="0" cellspacing="0"><tr><td style="padding-bottom:15px"><p style="margin:0;font-size:14px;font-weight:600;color:#92400e;text-transform:uppercase">ğŸ“Š Estado de Documentos:</p></td></tr>${datos.docsPendientes > 0 ? `<tr><td style="padding:10px 0"><p style="margin:0;font-size:18px;color:#92400e"><strong>â³ Pendientes de revisiÃ³n:</strong> ${datos.docsPendientes}</p></td></tr>` : ''}${datos.docsRechazados > 0 ? `<tr><td style="padding:10px 0"><p style="margin:0;font-size:18px;color:#dc2626"><strong>âŒ Rechazados (requieren correcciÃ³n):</strong> ${datos.docsRechazados}</p></td></tr>` : ''}<tr><td style="padding:10px 0;border-top:2px dashed #fbbf24"><p style="margin:0;font-size:16px;color:#92400e"><strong>ğŸ“… DÃ­as transcurridos:</strong> ${datos.diasTranscurridos} dÃ­as</p></td></tr></table></td></tr></table><table width="100%" cellpadding="0" cellspacing="0" style="background:#fee2e2;border-left:4px solid #dc2626;border-radius:8px;margin:25px 0"><tr><td style="padding:20px"><p style="margin:0 0 10px 0;font-size:14px;font-weight:600;color:#991b1b">âš¡ ACCIÃ“N REQUERIDA:</p><ul style="margin:0;padding-left:20px;color:#991b1b;font-size:14px;line-height:1.8"><li>Revisa el estado de tus documentos en tu panel</li><li>Corrige los documentos rechazados segÃºn las observaciones</li><li>Sube nuevamente los documentos corregidos</li><li>Completa este proceso lo antes posible</li></ul></td></tr></table><table width="100%" cellpadding="0" cellspacing="0" style="margin-top:40px"><tr><td align="center"><a href="https://coomotor-regalos.onrender.com/sistema-regalos/dashboards/empleado.html" style="display:inline-block;background:linear-gradient(135deg,#2563eb 0%,#1e40af 100%);color:white;text-decoration:none;padding:18px 45px;border-radius:12px;font-weight:700;font-size:16px;box-shadow:0 4px 15px rgba(37,99,235,0.4);text-transform:uppercase;letter-spacing:1px">ğŸ“¤ Ir a Mi Panel</a></td></tr></table><p style="margin:30px 0 0 0;font-size:14px;line-height:1.8;color:#666;text-align:center">Si tienes dudas, contacta al administrador del sistema</p></td></tr><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#1a5c3a 100%);padding:30px;text-align:center"><p style="margin:0 0 5px 0;font-size:14px;color:white;font-weight:600">COOMOTOR</p><p style="margin:0;font-size:12px;color:rgba(255,255,255,0.8)">Cooperativa de Motoristas del Huila</p><p style="margin:10px 0 0 0;font-size:12px;color:rgba(255,255,255,0.7)">Neiva, Huila - Colombia ğŸ‡¨ğŸ‡´</p></td></tr></table></td></tr></table></body></html>`;
        
        return await this.enviarEmail(datos.email, `âš ï¸ ${urgencia}: Documentos Pendientes - COOMOTOR`, html);
    }

    // PLANTILLA: Alerta de Plazo PrÃ³ximo a Vencer
    async enviarAlertaPlazo(datos) {
        const colorUrgencia = datos.diasRestantes <= 3 ? '#dc2626' : datos.diasRestantes <= 5 ? '#f59e0b' : '#3b82f6';
        const nivelUrgencia = datos.diasRestantes <= 3 ? 'ğŸš¨ URGENTE' : datos.diasRestantes <= 5 ? 'âš ï¸ IMPORTANTE' : 'â„¹ï¸ RECORDATORIO';
        
        const html = `<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');body{margin:0;padding:0;font-family:'Poppins',Arial,sans-serif}</style></head><body style="margin:0;padding:0;background:linear-gradient(135deg,#dc2626 0%,#991b1b 100%)"><table width="100%" cellpadding="0" cellspacing="0" style="padding:40px 20px"><tr><td align="center"><table width="600" cellpadding="0" cellspacing="0" style="background:white;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#c41e3a 100%);padding:50px 30px;text-align:center"><div style="font-size:80px;margin-bottom:10px">â°</div><h1 style="margin:0;color:white;font-size:36px;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.3)">COOMOTOR</h1><p style="margin:10px 0 0 0;color:rgba(255,255,255,0.9);font-size:16px">Alerta de Plazo</p></td></tr><tr><td style="padding:50px 40px"><table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:30px"><tr><td align="center"><div style="background:linear-gradient(135deg,${colorUrgencia} 0%,${colorUrgencia}dd 100%);padding:40px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,0.3)"><div style="font-size:80px;margin-bottom:15px;font-weight:900;color:white;text-shadow:2px 2px 4px rgba(0,0,0,0.3)">${datos.diasRestantes}</div><h2 style="margin:0;color:white;font-size:32px;font-weight:700;text-shadow:1px 1px 2px rgba(0,0,0,0.2)">DÃA${datos.diasRestantes !== 1 ? 'S' : ''} RESTANTE${datos.diasRestantes !== 1 ? 'S' : ''}</h2><p style="margin:10px 0 0 0;font-size:18px;color:rgba(255,255,255,0.95);font-weight:600">${nivelUrgencia}</p></div></td></tr></table><p style="margin:0 0 20px 0;font-size:18px;line-height:1.6;color:#333">Hola <strong style="color:#2563eb">${datos.nombre}</strong>,</p><p style="margin:0 0 25px 0;font-size:16px;line-height:1.8;color:#555">El plazo para completar las postulaciones de regalos navideÃ±os estÃ¡ prÃ³ximo a vencer.</p><table width="100%" cellpadding="0" cellspacing="0" style="background:linear-gradient(135deg,#fef3c7 0%,#fed7aa 100%);border-radius:12px;margin:30px 0;overflow:hidden"><tr><td style="padding:30px"><p style="margin:0 0 15px 0;font-size:14px;font-weight:600;color:#92400e;text-transform:uppercase">ğŸ“… InformaciÃ³n del Plazo:</p><table width="100%" cellpadding="0" cellspacing="0"><tr><td style="padding:10px 0"><p style="margin:0;font-size:16px;color:#92400e"><strong>Fecha lÃ­mite:</strong> ${datos.fechaLimite}</p></td></tr><tr><td style="padding:10px 0"><p style="margin:0;font-size:16px;color:#92400e"><strong>DÃ­as restantes:</strong> ${datos.diasRestantes} dÃ­a${datos.diasRestantes !== 1 ? 's' : ''}</p></td></tr>${datos.hijosRegistrados > 0 ? `<tr><td style="padding:10px 0"><p style="margin:0;font-size:16px;color:#92400e"><strong>Hijos registrados:</strong> ${datos.hijosRegistrados}</p></td></tr>` : ''}<tr><td style="padding:10px 0;border-top:2px dashed #fbbf24"><p style="margin:0;font-size:18px;color:#dc2626;font-weight:700"><strong>âš ï¸ Postulaciones pendientes:</strong> ${datos.postulacionesPendientes || 'Ninguna completada'}</p></td></tr></table></td></tr></table><table width="100%" cellpadding="0" cellspacing="0" style="background:#fee2e2;border-left:4px solid #dc2626;border-radius:8px;margin:25px 0"><tr><td style="padding:20px"><p style="margin:0 0 10px 0;font-size:14px;font-weight:600;color:#991b1b">ğŸš¨ ACCIÃ“N URGENTE REQUERIDA:</p><ul style="margin:0;padding-left:20px;color:#991b1b;font-size:14px;line-height:1.8"><li>Completa tus postulaciones antes del ${datos.fechaLimite}</li><li>Verifica que todos los documentos estÃ©n aprobados</li><li>Revisa la informaciÃ³n de tus hijos registrados</li><li>No pierdas esta oportunidad para tus hijos</li></ul></td></tr></table><table width="100%" cellpadding="0" cellspacing="0" style="margin-top:40px"><tr><td align="center"><a href="https://coomotor-regalos.onrender.com/sistema-regalos/dashboards/empleado.html" style="display:inline-block;background:linear-gradient(135deg,#dc2626 0%,#991b1b 100%);color:white;text-decoration:none;padding:20px 50px;border-radius:12px;font-weight:700;font-size:18px;box-shadow:0 6px 20px rgba(220,38,38,0.4);text-transform:uppercase;letter-spacing:1px;animation:pulse 2s infinite">âš¡ COMPLETAR AHORA</a></td></tr></table><p style="margin:30px 0 0 0;font-size:14px;line-height:1.8;color:#666;text-align:center">Â¡No dejes pasar esta oportunidad! Completa tu postulaciÃ³n hoy mismo.</p></td></tr><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#1a5c3a 100%);padding:30px;text-align:center"><p style="margin:0 0 5px 0;font-size:14px;color:white;font-weight:600">COOMOTOR</p><p style="margin:0;font-size:12px;color:rgba(255,255,255,0.8)">Cooperativa de Motoristas del Huila</p><p style="margin:10px 0 0 0;font-size:12px;color:rgba(255,255,255,0.7)">Neiva, Huila - Colombia ğŸ‡¨ğŸ‡´</p></td></tr></table></td></tr></table></body></html>`;
        
        return await this.enviarEmail(datos.email, `${nivelUrgencia} Plazo: ${datos.diasRestantes} dÃ­a${datos.diasRestantes !== 1 ? 's' : ''} restante${datos.diasRestantes !== 1 ? 's' : ''} - COOMOTOR`, html);
    }

    // PLANTILLA: ConfirmaciÃ³n de Entrega de Regalo
    async enviarConfirmacionEntrega(datos) {
        const html = `<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');body{margin:0;padding:0;font-family:'Poppins',Arial,sans-serif}</style></head><body style="margin:0;padding:0;background:linear-gradient(135deg,#11998e 0%,#38ef7d 100%)"><table width="100%" cellpadding="0" cellspacing="0" style="padding:40px 20px"><tr><td align="center"><table width="600" cellpadding="0" cellspacing="0" style="background:white;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#c41e3a 100%);padding:50px 30px;text-align:center"><div style="font-size:80px;margin-bottom:10px">ğŸ</div><h1 style="margin:0;color:white;font-size:36px;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.3)">COOMOTOR</h1><p style="margin:10px 0 0 0;color:rgba(255,255,255,0.9);font-size:16px">ConfirmaciÃ³n de Entrega</p></td></tr><tr><td style="padding:50px 40px"><table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:30px"><tr><td align="center"><div style="background:linear-gradient(135deg,#11998e 0%,#38ef7d 100%);padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(17,153,142,0.3)"><div style="font-size:60px;margin-bottom:10px">ğŸ‰</div><h2 style="margin:0;color:white;font-size:28px;font-weight:700;text-shadow:1px 1px 2px rgba(0,0,0,0.2)">Â¡Regalo Listo para Entregar!</h2></div></td></tr></table><p style="margin:0 0 20px 0;font-size:18px;line-height:1.6;color:#333">Hola <strong style="color:#2563eb">${datos.nombre}</strong>,</p><p style="margin:0 0 25px 0;font-size:16px;line-height:1.8;color:#555">Â¡Tenemos excelentes noticias! El regalo para <strong style="color:#c41e3a">${datos.nombreHijo}</strong> estÃ¡ listo para ser entregado.</p><table width="100%" cellpadding="0" cellspacing="0" style="background:linear-gradient(135deg,#e0f2fe 0%,#dbeafe 100%);border-radius:12px;margin:30px 0;overflow:hidden"><tr><td style="padding:30px"><p style="margin:0 0 15px 0;font-size:14px;font-weight:600;color:#2563eb;text-transform:uppercase">ğŸ InformaciÃ³n del Regalo:</p><table width="100%" cellpadding="0" cellspacing="0"><tr><td style="padding:10px 0"><p style="margin:0;font-size:16px;color:#1e40af"><strong>NiÃ±o/a:</strong> ${datos.nombreHijo}</p></td></tr><tr><td style="padding:10px 0"><p style="margin:0;font-size:16px;color:#1e40af"><strong>Edad:</strong> ${datos.edad} aÃ±os</p></td></tr><tr><td style="padding:10px 0"><p style="margin:0;font-size:16px;color:#1e40af"><strong>Fecha de aprobaciÃ³n:</strong> ${datos.fechaAprobacion}</p></td></tr></table></td></tr></table><table width="100%" cellpadding="0" cellspacing="0" style="background:#dcfce7;border-left:4px solid #16a34a;border-radius:8px;margin:25px 0"><tr><td style="padding:20px"><p style="margin:0 0 10px 0;font-size:14px;font-weight:600;color:#166534">ğŸ“ PRÃ“XIMOS PASOS:</p><ul style="margin:0;padding-left:20px;color:#166534;font-size:14px;line-height:1.8"><li>Pronto recibirÃ¡s informaciÃ³n sobre fecha y lugar de entrega</li><li>Mantente atento a tu correo electrÃ³nico</li><li>Prepara un documento de identidad para el dÃ­a de la entrega</li><li>Si tienes dudas, contacta al administrador</li></ul></td></tr></table><table width="100%" cellpadding="0" cellspacing="0" style="margin-top:40px"><tr><td align="center" style="padding:30px;background:linear-gradient(135deg,#fef3c7 0%,#fed7aa 100%);border-radius:12px"><div style="font-size:48px;margin-bottom:15px">ğŸ…ğŸ„âœ¨</div><p style="margin:0;font-size:20px;font-weight:700;color:#c41e3a">Â¡Felices Fiestas!</p><p style="margin:10px 0 0 0;font-size:14px;color:#92400e">Que la magia de la Navidad llene tu hogar de alegrÃ­a</p></td></tr></table></td></tr><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#1a5c3a 100%);padding:30px;text-align:center"><p style="margin:0 0 5px 0;font-size:14px;color:white;font-weight:600">COOMOTOR</p><p style="margin:0;font-size:12px;color:rgba(255,255,255,0.8)">Cooperativa de Motoristas del Huila</p><p style="margin:10px 0 0 0;font-size:12px;color:rgba(255,255,255,0.7)">Neiva, Huila - Colombia ğŸ‡¨ğŸ‡´</p></td></tr></table></td></tr></table></body></html>`;
        
        return await this.enviarEmail(datos.email, `ğŸ Regalo Listo: ${datos.nombreHijo} - COOMOTOR`, html);
    }

    // PLANTILLA: Encuesta de SatisfacciÃ³n Post-Entrega
    async enviarEncuestaSatisfaccion(datos) {
        const urlEncuesta = `https://coomotor-regalos.onrender.com/sistema-regalos/encuesta.html?p=${datos.postulacionId}`;
        
        const html = `<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');body{margin:0;padding:0;font-family:'Poppins',Arial,sans-serif}</style></head><body style="margin:0;padding:0;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)"><table width="100%" cellpadding="0" cellspacing="0" style="padding:40px 20px"><tr><td align="center"><table width="600" cellpadding="0" cellspacing="0" style="background:white;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#c41e3a 100%);padding:50px 30px;text-align:center"><div style="font-size:80px;margin-bottom:10px">ğŸ“‹</div><h1 style="margin:0;color:white;font-size:36px;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.3)">COOMOTOR</h1><p style="margin:10px 0 0 0;color:rgba(255,255,255,0.9);font-size:16px">Tu OpiniÃ³n es Importante</p></td></tr><tr><td style="padding:50px 40px"><table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:30px"><tr><td align="center"><div style="background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(240,147,251,0.3)"><div style="font-size:60px;margin-bottom:10px">â­</div><h2 style="margin:0;color:white;font-size:28px;font-weight:700;text-shadow:1px 1px 2px rgba(0,0,0,0.2)">Encuesta de SatisfacciÃ³n</h2></div></td></tr></table><p style="margin:0 0 20px 0;font-size:18px;line-height:1.6;color:#333">Hola <strong style="color:#2563eb">${datos.nombre}</strong>,</p><p style="margin:0 0 25px 0;font-size:16px;line-height:1.8;color:#555">Esperamos que <strong style="color:#c41e3a">${datos.nombreHijo}</strong> haya disfrutado su regalo navideÃ±o. Tu opiniÃ³n nos ayuda a mejorar cada aÃ±o.</p><table width="100%" cellpadding="0" cellspacing="0" style="background:linear-gradient(135deg,#fef3c7 0%,#fed7aa 100%);border-radius:12px;margin:30px 0;overflow:hidden"><tr><td style="padding:30px"><p style="margin:0 0 15px 0;font-size:14px;font-weight:600;color:#92400e;text-transform:uppercase">ğŸ“ AyÃºdanos a Mejorar:</p><ul style="margin:0;padding-left:20px;color:#92400e;font-size:14px;line-height:1.8"><li>Â¿CÃ³mo fue tu experiencia con el proceso?</li><li>Â¿El regalo fue apropiado para la edad de tu hijo/a?</li><li>Â¿QuÃ© podemos mejorar para el prÃ³ximo aÃ±o?</li><li>Â¿RecomendarÃ­as este programa a otros empleados?</li></ul></td></tr></table><table width="100%" cellpadding="0" cellspacing="0" style="background:#e0f2fe;border-left:4px solid #3b82f6;border-radius:8px;margin:25px 0"><tr><td style="padding:20px"><p style="margin:0 0 10px 0;font-size:14px;font-weight:600;color:#1e40af">â±ï¸ SOLO 2 MINUTOS:</p><p style="margin:0;font-size:14px;color:#1e40af;line-height:1.8">La encuesta es breve y anÃ³nima. Tus respuestas nos ayudarÃ¡n a hacer que el programa de regalos sea aÃºn mejor el prÃ³ximo aÃ±o.</p></td></tr></table><table width="100%" cellpadding="0" cellspacing="0" style="margin-top:40px"><tr><td align="center"><a href="${urlEncuesta}" style="display:inline-block;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;text-decoration:none;padding:20px 50px;border-radius:12px;font-weight:700;font-size:18px;box-shadow:0 6px 20px rgba(102,126,234,0.4);text-transform:uppercase;letter-spacing:1px">â­ RESPONDER ENCUESTA</a></td></tr></table><p style="margin:30px 0 0 0;font-size:13px;line-height:1.8;color:#999;text-align:center">Si el botÃ³n no funciona, copia este enlace en tu navegador:<br><span style="color:#667eea;word-break:break-all">${urlEncuesta}</span></p><table width="100%" cellpadding="0" cellspacing="0" style="margin-top:40px"><tr><td align="center" style="padding:25px;background:linear-gradient(135deg,#dcfce7 0%,#d1fae5 100%);border-radius:12px"><p style="margin:0;font-size:18px;font-weight:600;color:#166534">Â¡Gracias por tu participaciÃ³n! ğŸ„</p><p style="margin:10px 0 0 0;font-size:14px;color:#166534">COOMOTOR - Juntos construimos futuro</p></td></tr></table></td></tr><tr><td style="background:linear-gradient(135deg,#2563eb 0%,#1a5c3a 100%);padding:30px;text-align:center"><p style="margin:0 0 5px 0;font-size:14px;color:white;font-weight:600">COOMOTOR</p><p style="margin:0;font-size:12px;color:rgba(255,255,255,0.8)">Cooperativa de Motoristas del Huila</p><p style="margin:10px 0 0 0;font-size:12px;color:rgba(255,255,255,0.7)">Neiva, Huila - Colombia ğŸ‡¨ğŸ‡´</p></td></tr></table></td></tr></table></body></html>`;
        
        return await this.enviarEmail(datos.email, `â­ Tu OpiniÃ³n es Importante - COOMOTOR`, html);
    }
}

module.exports = new NotificationService();
